

# FATE-Flow Client Command Line Interface v2

[TOC]



## Usage

Before using fate flow client command line interface (CLI), please make sure that you have activated the virtual environment of FATE. For more details about how to activate virtual environment, please read the documentation of deployment. 

In this version of client CLI, commands are seperated into serveral classes, including *job*, *data*, *model*, *component* and etc. And all of these classes have a common parent (CLI entry) named *'flow'*, which means you can type *'flow'* in your terminal window to find out all of these classes and also their subcommands. 

```bash
[IN]
flow

[OUT]
Usage: flow [OPTIONS] COMMAND [ARGS]...

  Fate Flow Client

Options:
  -h, --help  Show this message and exit.

Commands:
  component   Component Operations
  data        Data Operations
  job         Job Operations
  model       Model Operations
  queue       Queue Operations
  table       Table Operations
  task        Task Operations
```

![flow](/Users/izhfeng/工作文件暂存/微众银行/FATE/Flow CLI相关/cli_doc/flow.png)

For more details, please check this documentation or try ```flow --help``` for help.



## Job

### ```submit```

- *Description*: Submit a pipeline job.
- *Arguments*:

| No.  | Argument  | Flag_1 |    Flag_2     | Required |                         Description                          |
| :--: | :-------: | :----: | :-----------: | :------: | :----------------------------------------------------------: |
|  1   | conf_path |  `-c`  | `--conf-path` |   Yes    |               Runtime configuration file path                |
|  2   | dsl_path  |  `-d`  | `--dsl-path`  |   Yes    | Domain-specific language(DSL) file path. If the type of job is 'predict', you can leave this feature blank, or you can provide a valid dsl file to replace the one that aotumatically generated by fate. |

- *Examples*:

```bash
flow job submit -c fate_flow/examples/test_hetero_lr_job_conf.json -d fate_flow/examples/test_hetero_lr_job_dsl.json
```



### ```stop```

- *Description*: Cancel or stop a specified job. 
- *Arguments*:
| No.  | Argument | Flag_1 |   Flag_2   | Required | Description |
| :--: | :------: | :----: | :--------: | :------: | :---------: |
|  1   |  job_id  |  `-j`  | `--job_id` |   Yes    |   Job ID    |

- *Examples*:
```bash
flow job stop -j $JOB_ID
```



### ```query```

- *Description*: Query job information by filters.
- *Arguments*:
| No.  |    Argument    | Flag_1 |       Flag_2       | Required |  Description   |
| :--: | :------------: | :----: | :----------------: | :------: | :------------: |
|  1   |     job_id     |  `-j`  |     `--job_id`     |    No    |     Job ID     |
|  2   |      role      |  `-r`  |      `--role`      |    No    |      Role      |
|  3   |    party_id    |  `-p`  |    `--party_id`    |    No    |    Party ID    |
|  4   | component_name | `-cpn` | `--component_name` |    No    | Component Name |
|  5   |     status     |  `-s`  |     `--status`     |    No    |   Job status   |

- *Examples*:
```bash
flow job query -r guest -p 9999 -s success
flow job query -j $JOB_ID -cpn hetero_feature_binning_0
```



### ```clean```

- *Description*:  Clean processor,data table and metric data.
- *Arguments*:

| No.  |    Argument    | Flag_1 |       Flag_2       | Required |   Description   |
| :--: | :------------: | :----: | :----------------: | :------: | :-------------: |
|  1   |     job_id     |  `-j`  |     `--job_id`     |    No    | A valid job id. |
|  2   |      role      |  `-r`  |      `--role`      |    No    |      Role       |
|  3   |    party_id    |  `-p`  |    `--party_id`    |    No    |    Party ID     |
|  4   | component_name | `-cpn` | `--component_name` |    No    | Component Name  |

- *Examples*:

```bash
flow job clean -r guest -p 9999
flow job clean -j $JOB_ID -cpn hetero_feature_binning_0
```



### ```view```

- *Description*: Query data view information by filters.

- *Arguments*:
| No.  |    Argument    | Flag_1 |       Flag_2       | Required |  Description   |
| :--: | :------------: | :----: | :----------------: | :------: | :------------: |
|  1   |     job_id     |  `-j`  |     `--job_id`     |    No    |     Job ID     |
|  2   |      role      |  `-r`  |      `--role`      |    No    |      Role      |
|  3   |    party_id    |  `-p`  |    `--party_id`    |    No    |    Party ID    |
|  4   | component_name | `-cpn` | `--component_name` |    No    | Component Name |
|  5   |     status     |  `-s`  |     `--status`     |    No    |   Job Status   |

- *Examples*:
```bash
flow job view -r guest -p 9999
flow job view -j $JOB_ID -cpn hetero_feature_binning_0
```



### ```config```
- *Description*: Download the configuration of a specified job.
- *Arguments*:
| No.  |  Argument   | Flag_1 |     Flag_2      | Required |      Description      |
| :--: | :---------: | :----: | :-------------: | :------: | :-------------------: |
|  1   |   job_id    |  `-j`  |   `--job_id`    |   Yes    |        Job ID         |
|  2   |    role     |  `-r`  |    `--role`     |   Yes    |         Role          |
|  3   |  party_id   |  `-p`  |  `--party_id`   |   Yes    |       Party ID        |
|  4   | output_path |  `-o`  | `--output-path` |   Yes    | Specified Output Path |

- *Examples*：
```bash
flow job config -j $JOB_ID -r host -p 10000 --output-path ./examples/
```



### ```log```

- *Description*: Download log files of a specified job.
- *Arguments*: 
| No.  |  Argument   | Flag_1 |     Flag_2      | Required |      Description      |
| :--: | :---------: | :----: | :-------------: | :------: | :-------------------: |
|  1   |   job_id    |  `-j`  |   `--job_id`    |   Yes    |        Job ID         |
|  2   | output_path |  `-o`  | `--output-path` |   Yes    | Specified Output Path |

- *Examples*:
```bash
flow job log -j JOB_ID --output-path ./examples/
```



### ```list```

- *Description*: List jobs.
- *Arguments*: 

| No.  | Argument | Flag_1 |  Flag_2   | Required |                Description                 |
| :--: | :------: | :----: | :-------: | :------: | :----------------------------------------: |
|  1   |  limit   |  `-l`  | `--limit` |    No    | Number of records to return. (default: 10) |

- *Examples*:

```bash
flow job list
flow job list -l 30
```



### ```dsl```

- *Description*: A predict dsl generator.
- *Arguments*: 

| No.  |    Argument    | Flag_1 |       Flag_2       | Required |                         Description                          |
| :--: | :------------: | :----: | :----------------: | :------: | :----------------------------------------------------------: |
|  1   |    cpn_list    |        |    `--cpn-list`    |    No    |       User inputs a string to specify component list.        |
|  2   |    cpn_path    |        |    `--cpn-path`    |    No    | User specifies a file path which records the component list. |
|  3   | train_dsl_path |        | `--train-dsl-path` |   Yes    |           User specifies the train dsl file path.            |
|  4   |  output_path   |  `-o`  |  `--output-path`   |    No    |            User specifies output directory path.             |

- *Examples*:

```bash
flow job dsl --cpn-path fate_flow/examples/component_list.txt --train-dsl-path fate_flow/examples/test_hetero_lr_job_dsl.json

flow job dsl --cpn-path fate_flow/examples/component_list.txt --train-dsl-path fate_flow/examples/test_hetero_lr_job_dsl.json -o fate_flow/examples/

flow job dsl --cpn-list "dataio_0, hetero_feature_binning_0, hetero_feature_selection_0, evaluation_0" --train-dsl-path fate_flow/examples/test_hetero_lr_job_dsl.json -o fate_flow/examples/
        
flow job dsl --cpn-list [dataio_0,hetero_feature_binning_0,hetero_feature_selection_0,evaluation_0] --train-dsl-path fate_flow/examples/test_hetero_lr_job_dsl.json -o fate_flow/examples/
```



## Component (TRACKING)
### ```parameters```
- *Description*: Query the arguments of a specified component.
- *Arguments*: 
| No.  |    Argument    | Flag_1 |       Flag_2       | Required |  Description   |
| :--: | :------------: | :----: | :----------------: | :------: | :------------: |
|  1   |     job_id     |  `-j`  |     `--job_id`     |   Yes    |     Job ID     |
|  2   |      role      |  `-r`  |      `--role`      |   Yes    |      Role      |
|  3   |    party_id    |  `-p`  |    `--party_id`    |   Yes    |    Party ID    |
|  4   | component_name | `-cpn` | `--component_name` |   Yes    | Component Name |

- *Examples*:

```bash
flow component parameters -j $JOB_ID -r host -p 10000 -cpn hetero_feature_binning_0
```



### ```metric-all```

- *Description*: Query all metric data.
- *Arguments*: 
| No.  |    Argument    | Flag_1 |       Flag_2       | Required |  Description   |
| :--: | :------------: | :----: | :----------------: | :------: | :------------: |
|  1   |     job_id     |  `-j`  |     `--job_id`     |   Yes    |     Job ID     |
|  2   |      role      |  `-r`  |      `--role`      |   Yes    |      Role      |
|  3   |    party_id    |  `-p`  |    `--party_id`    |   Yes    |    Party ID    |
|  4   | component_name | `-cpn` | `--component_name` |   Yes    | Component Name |

- *Examples*:
```bash
flow component metric-all -j $JOB_ID -r host -p 10000 -cpn hetero_feature_binning_0
```



### ```metrics```

- *Description*: Query the list of metrics.
- *Arguments*: 
| No.  |    Argument    | Flag_1 |       Flag_2       | Required |  Description   |
| :--: | :------------: | :----: | :----------------: | :------: | :------------: |
|  1   |     job_id     |  `-j`  |     `--job_id`     |   Yes    |     Job ID     |
|  2   |      role      |  `-r`  |      `--role`      |   Yes    |      Role      |
|  3   |    party_id    |  `-p`  |    `--party_id`    |   Yes    |    Party ID    |
|  4   | component_name | `-cpn` | `--component_name` |   Yes    | Component Name |

- *Examples*:
```bash
flow component metrics -j $JOB_ID -r host -p 10000 -cpn hetero_feature_binning_0
```



### ```metric-delete```

- *Description*:  Delete specified metric. 
- *Arguments*: 

| No.  | Argument | Flag_1 |   Flag_2   | Required |                  Description                  |
| :--: | :------: | :----: | :--------: | :------: | :-------------------------------------------: |
|  1   |   date   |  `-d`  |  `--date`  |    No    | An 8-Digit Valid Date, Format Like 'YYYYMMDD' |
|  2   |  job_id  |  `-j`  | `--job_id` |    No    |                    Job ID                     |

- *Examples*:

```bash
# NOTICE: If you input both two optional arguments, the 'date' argument will be detected in priority while the 'job_id' argument would be ignored.
flow component metric-delete -d 20200101
flow component metric-delete -j $JOB_ID
```



### ```output-model```
- *Description*: Query a specified component model.
- *Arguments*: 

| No.  |    Argument    | Flag_1 |       Flag_2       | Required |  Description   |
| :--: | :------------: | :----: | :----------------: | :------: | :------------: |
|  1   |     job_id     |  `-j`  |     `--job_id`     |   Yes    |     Job ID     |
|  2   |      role      |  `-r`  |      `--role`      |   Yes    |      Role      |
|  3   |    party_id    |  `-p`  |    `--party_id`    |   Yes    |    Party ID    |
|  4   | component_name | `-cpn` | `--component_name` |   Yes    | Component Name |

- *Examples*:
```bash
flow component output-model -j $JOB_ID -r host -p 10000 -cpn hetero_feature_binning_0
```



### ```output-data```
- *Description*: Download the output data of a specified component.
- *Arguments*: 
| No.  |    Argument    | Flag_1 |       Flag_2       | Required |                Description                 |
| :--: | :------------: | :----: | :----------------: | :------: | :----------------------------------------: |
|  1   |     job_id     |  `-j`  |     `--job_id`     |   Yes    |                   Job ID                   |
|  2   |      role      |  `-r`  |      `--role`      |   Yes    |                    Role                    |
|  3   |    party_id    |  `-p`  |    `--party_id`    |   Yes    |                  Party ID                  |
|  4   | component_name | `-cpn` | `--component_name` |   Yes    |               Component Name               |
|  5   |  output_path   |  `-o`  |  `--output-path`   |   Yes    |           Specified Output Path            |
|  6   |     limit      |  `-l`  |     `--limit`      |    No    | Number of records to return. (default: 10) |

- *Examples*:
```bash
flow component output-data -j $JOB_ID -r host -p 10000 -cpn hetero_feature_binning_0 --output-path ./examples/
```



### ```output-data-table```

- *Description*:  View table name and namespace.
- *Arguments*: 
| No.  |    Argument    | Flag_1 |       Flag_2       | Required |  Description   |
| :--: | :------------: | :----: | :----------------: | :------: | :------------: |
|  1   |     job_id     |  `-j`  |     `--job_id`     |   Yes    |     Job ID     |
|  2   |      role      |  `-r`  |      `--role`      |   Yes    |      Role      |
|  3   |    party_id    |  `-p`  |    `--party_id`    |   Yes    |    Party ID    |
|  4   | component_name | `-cpn` | `--component_name` |   Yes    | Component Name |

- *Examples*:
```bash
flow component output-data-table -j $JOB_ID -r host -p 10000 -cpn hetero_feature_binning_0
```



### ```list```

- *Description*:  List components of a specified job.
- *Arguments*: 

| No.  | Argument | Flag_1 |   Flag_2   | Required | Description |
| :--: | :------: | :----: | :--------: | :------: | :---------: |
|  1   |  job_id  |  `-j`  | `--job_id` |   Yes    |   Job ID    |

- *Examples*:

```bash
flow component list -j $JOB_ID
```





## Data

### ```download```
- *Description*: Download Data Table.
- *Arguments*: 
| No.  | Argument  | Flag_1 |    Flag_2     | Required |       Description       |
| :--: | :-------: | :----: | :-----------: | :------: | :---------------------: |
|  1   | conf_path |  `-c`  | `--conf-path` |   Yes    | Configuration file path |

- *Examples*:
```bash
flow data download -c fate_flow/examples/download_host.json
```



### ```upload```
- *Description*: Upload Data Table.
- *Arguments*: 
| No.  | Argument  | Flag_1 |    Flag_2     | Required |                         Description                          |
| :--: | :-------: | :----: | :-----------: | :------: | :----------------------------------------------------------: |
|  1   | conf_path |  `-c`  | `--conf-path` |   Yes    |                   Configuration file path                    |
|  2   |  verbose  |  `-v`  |  `--verbose`  |    No    | If specified, verbose mode will be turn on. Users can have feedback on upload task in progress. (Default: False) |
|  3   |   drop    |  `-d`  |   `--drop`    |    No    | If specified, data of old version would be replaced by the current version. Otherwise, current upload task would be rejected. (Default: False) |

- *Examples*:
```bash
flow data upload -c fate_flow/examples/upload_guest.json
flow data upload -c fate_flow/examples/upload_host.json --verbose --drop
```



### ```upload-history```
- *Description*: Query Upload Table History.
- *Arguments*: 
| No.  | Argument | Flag_1 |   Flag_2   | Required |                Description                 |
| :--: | :------: | :----: | :--------: | :------: | :----------------------------------------: |
|  1   |  limit   |  `-l`  | `--limit`  |    No    | Number of records to return. (default: 10) |
|  2   |  job_id  |  `-j`  | `--job_id` |    No    |                   Job ID                   |

- *Examples*:
```bash
flow data upload-history -l 20
flow data upload-history --job-id $JOB_ID
```





## TASK

### ```query```

- *Description*: Query task information by filters.
- *Arguments*: 

| No.  |    Argument    | Flag_1 |       Flag_2       | Required |  Description   |
| :--: | :------------: | :----: | :----------------: | :------: | :------------: |
|  1   |     job_id     |  `-j`  |     `--job_id`     |    No    |     Job ID     |
|  2   |      role      |  `-r`  |      `--role`      |    No    |      Role      |
|  3   |    party_id    |  `-p`  |    `--party_id`    |    No    |    Party ID    |
|  4   | component_name | `-cpn` | `--component_name` |    No    | Component Name |
|  5   |     status     |  `-s`  |     `--status`     |    No    |   Job Status   |

- *Examples*:

```bash
flow task query -j $JOB_ID -p 9999 -r guest
flow task query -cpn hetero_feature_binning_0 -s success
```



### ```list```

- *Description*: List tasks.
- *Arguments*: 

| No.  | Argument | Flag_1 |  Flag_2   | Required |                Description                 |
| :--: | :------: | :----: | :-------: | :------: | :----------------------------------------: |
|  1   |  limit   |  `-l`  | `--limit` |    No    | Number of records to return. (default: 10) |

- *Examples*:

```bash
flow task list
flow task list -l 25
```






## Model

### ```load```
- *Description*: Load model.
- *Arguments*: 
| No.  | Argument  | Flag_1 |    Flag_2     | Required |           Description           |
| :--: | :-------: | :----: | :-----------: | :------: | :-----------------------------: |
|  1   | conf_path |  `-c`  | `--conf-path` |   Yes    | Runtime configuration file path |

- *Examples*:

```bash
flow model load -c fate_flow/examples/publish_load_model.json
```



### ```bind```
- *Description*: Bind model.
- *Arguments*: 

| No.  | Argument  | Flag_1 |    Flag_2     | Required |           Description           |
| :--: | :-------: | :----: | :-----------: | :------: | :-----------------------------: |
|  1   | conf_path |  `-c`  | `--conf-path` |   Yes    | Runtime configuration file path |

- *Examples*:

```bash
flow model bind -c fate_flow/examples/bind_model_service.json
```



### ```import```

- *Description*: Import model
- *Arguments*: 

| No.  |   Argument    | Flag_1 |     Flag_2      | Required |                         Description                          |
| :--: | :-----------: | :----: | :-------------: | :------: | :----------------------------------------------------------: |
|  1   |   conf_path   |  `-c`  |  `--conf-path`  |   Yes    |               Runtime configuration file path                |
|  2   | from-database |        | --from-database |    No    | If specified and there is a valid database environment, fate flow will import model from database which you specified in configuration file. |

- *Examples*:

```bash
flow model import -c fate_flow/examples/import_model.json
flow model import -c fate_flow/examples/restore_model.json --from-database
```



### ```export```

- *Description*: Export model
- *Arguments*: 

| No.  |  Argument   | Flag_1 |     Flag_2      | Required |                         Description                          |
| :--: | :---------: | :----: | :-------------: | :------: | :----------------------------------------------------------: |
|  1   |  conf_path  |  `-c`  |  `--conf-path`  |   Yes    |               Runtime configuration file path                |
|  2   | to-database |        | `--to-database` |    No    | If specified and there is a valid database environment, fate flow will export model to database which you specified in configuration file. |

- *Examples*:

```bash
flow model export -c fate_flow/examples/export_model.json
flow model export -c fate_flow/examplse/store_model.json --to-database
```





## Table

### ```info```

- *Description*: Query Table Information.
- *Arguments*: 

| No.  |  Argument  | Flag_1 |     Flag_2     | Required | Description |
| :--: | :--------: | :----: | :------------: | :------: | :---------: |
|  1   | namespace  |  `-n`  | `--namespace`  |   Yes    |  Namespace  |
|  2   | table_name |  `-t`  | `--table-name` |   Yes    | Table Name  |

- *Examples*:

```bash
flow table info -n $NAMESPACE -t $TABLE_NAME
```



### ```delete```

- *Description*: Delete A Specified Table.
- *Arguments*: 

| No.  |    Argument    | Flag_1 |       Flag_2       | Required |  Description   |
| :--: | :------------: | :----: | :----------------: | :------: | :------------: |
|  1   |   namespace    |  `-n`  |   `--namespace`    |    No    |   Namespace    |
|  2   |   table_name   |  `-t`  |   `--table_name`   |    No    |   Job Status   |
|  3   |     job_id     |  `-j`  |     `--job_id`     |    No    | A valid job id |
|  4   |      role      |  `-r`  |      `--role`      |    No    |      Role      |
|  5   |    party_id    |  `-p`  |    `--party_id`    |    No    |    Party ID    |
|  6   | component_name | `-cpn` | `--component_name` |    No    | Component Name |

- *Examples*:

```bash
flow table delete -n $NAMESPACE -t $TABLE_NAME
flow table delete -j $JOB_ID -r guest -p 9999
```





## Queue

### ```clean```

- *Description*: Cancel all jobs in queue. 
- *Arguments*: None.
- *Examples*:

```bash
flow queue clean
```

